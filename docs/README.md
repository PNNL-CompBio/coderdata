
# Locally Rendering Sphinx

Guide to rendering the documentation site using Sphinx. 

This document includes:
- The coderdata/docs directory structure
- Sphinx commands
- Guide to updating the documentation site 
- Helpful sphinx features
- Hosting the documentation


## Directory Structure

![Directory Structure](sphinx_dir_struct.jpg?raw=true)

## Sphinx Commands

### Dependencies

Included in `coderdata/docs/requirements.txt`. Extra installations that enable various sphinx extensions.

- **sphinx** 
- **myst-parser**   - adds support for markdown files
- **sphinx-design** - provides extra design functions (i.e buttons and grids)
- **nbsphinx**      - enables rendering of .ipynb files
- **sphinx_tabs**   - adds tabbed content components

### Build

To build the Sphinx documentation locally, navigate to the `docs` directory and run the `sphinx-build` command. This command processes the content files from the `source` directory and generates the rendered HTML output in the `build` directory.

```sh
$ cd ../coderdata/docs

$ python -m sphinx.cmd.build -M html <SOURCEDIR/> <OUTPUTDIR/>

$ python -m sphinx.cmd.build -M html source/ build/
```
To view the site open `coderdata/docs/build/html/index.html`.

### Quickstart

To create a basic sphinx set-up in a local repository use sphinx quickstart command.

```sh
$ cd ../repo/docs
$ python -m sphinx.cmd.quickstart
```
Questions will follow this command and when it prompts if you'd like to separate the source and build directories select yes. 

## Updating Documentation Site 

The `conf.py` file is the central configuration file for Sphinx and it determines the behavior and appearance of the generated documentation. Specifically it configures extensions, defines metadata, controls output settings, and customizes sphinx behavior. The `index.rst` file is the starting page for the Sphinx documentation build process. It acts as the root file, linking all other pages and defining the document hierarchy. All other .md and .rst files are added and internally referenced within the index page or within the sidebar. 

Once all necessary updates are made then use the [Build Command](#build).

### Pages

To update pages navigate to `docs/source`, all .rst and .md files live here. Here is a reference of the main pages within the documentation site. 

|  Main Pages      | File Name                                                               | Content                        |
| -----------------| ----------------------------------------------------------------------- | ------------------------------ |
| Home Page        | [index.rst](source/index.rst)                                           | Introduction and Install       |
| Usage            | [usage.md](source/usage.md)                                             | API and CLI                    |
| API Reference    | [APIreference.rst](source/APIreference.rst)                             | Sphinx autogenerated docstrings|
| Datasets         | [datasets_included.rst](source/datasets_included.rst)                   | Datasets overview table        |
| Tutorials        | [tutorials.rst](source/tutorials.rst)                                   | Deep Learning Tutorial         |
| Contribute       | [contribution_guide.rst](source/contribution_guide.rst) *includes contribution.md and add_code_guide.md* | Contribution Guide             |

**Note:** 
- When adding pages, reStructuredText files are the most sphinx-friendly and easily enable use of helpful sphinx features. However, Markdown files can be used and will render properly when the myst-parser extension is used. 
- The **tutorials** includes the html file of the jupyter notebook. The docsite_tutorial.html and .ipynb can be found in `docs/source/_static`. Could potentially use the nbsphinx to render the notebooks during the sphinx build, however, I found using the html version was the cleanest way to include the tutorials. Also, some different dependencies are needed to execute the `docsite_tutorial.ipynb`, so I suggest copying the .ipynb into a different environment when making updates to the file. Then output a new `docsite_tutorials.html` that reflects the changes and replacing the old .ipynb and .html files with corrected files.

### Images and Graphics

To add any new images input them into `docs/source/_static`. The coderdata_header.jpg was made using [canva](https://www.canva.com/). The home page graphic coderdata_1.jpg was made using biorender. The designs are shared with team members so that they can easily be edited if needed!

### Site Theme and Design

The original sphinx theme used is 'sphinxdoc', however, to change certain aspects an additional file custom.css was included to override the sphinxdoc theme. To update the custom theme navigate to `docs/source/_static/custom.css`. Changes to the sidebar can be made in `docs/source/_templates/my_custom_sidebar.html`. Any other custom templates will be added to `docs/source/_templates`.

Note: The sphinxdoc theme is automatically generated during the build command into `docs/build/html/_static/sphinxdoc.css`. It is regenerated everytime sphinx build runs so changes to the theme must be made in custom.css. 


## Helpful Sphinx Features

### Site Links

- [Sphinx Documentation](https://www.sphinx-doc.org/en/master/index.html)
- [Sphinxdoc Sample](https://sphinx-themes.org/sample-sites/default-sphinxdoc/)
- [Full List of Directives in Sphinx](https://www.sphinx-doc.org/en/master/usage/restructuredtext/basics.html#rst-directives)
<!-- - [Generating Documentation from docstrings](https://sphinx-rtd-tutorial.readthedocs.io/en/latest/build-the-docs.html#building-our-documentation) -->


### Directives and Examples Used in CoderData Documentation

- .. automodule::
This is used to generate documentation from the package. It is used in API reference.

```sh
.. automodule:: <pkg>.module
   :members: <function>
   :undoc-members:
   :show-inheritance:
```

- .. include::
To include content from another file. Example shows how to render a markdown file when using the include call. This will directly include the content from the document called. 

```sh
.. include:: guide.md
   :parser: myst_parser.sphinx_ 
```

- :ref:

Use to include a reference a document included within the repository.

```sh
:ref: guide.md
```

- .. image::

```sh
.. image:: _static/image.png   
		:align: center
		:scale: 100%
      :height: 500px
      :widht: 500px
```
## Using GitHub Actions to Host Site

