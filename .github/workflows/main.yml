name: CI

on:
  push:
    branches:
      - builder_branch_JJ

jobs:
  build-hcmi:
    runs-on: ubuntu-20.04
    environment: github-pages
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: Build HCMI Image
      run: docker build -t hcmi-builder -f docker/Dockerfile.hcmi .
    - name: Run HCMI Container
      run: docker run hcmi-builder

  build-beataml:
    runs-on: ubuntu-20.04
    environment: github-pages
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: Build BeatAML Image
      run: docker build -t beataml-builder -f docker/Dockerfile.beataml .
    - name: Run BeatAML Container
      run: docker run -e SYNAPSE_TOKEN=${{ secrets.SYNAPSE_TOKEN_SECRET }} beataml-builder
